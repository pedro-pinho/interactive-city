{"_id":"node-red-contrib-facebook-messenger-writer","_rev":"3-bd0e692af7600611eebbfd94ff839173","name":"node-red-contrib-facebook-messenger-writer","description":"A node to write output to Facebook Messenger","dist-tags":{"latest":"0.0.3"},"versions":{"0.0.1":{"name":"node-red-contrib-facebook-messenger-writer","version":"0.0.1","description":"A node to write output to Facebook Messenger","dependencies":{"request":"~2.53.0"},"repository":{"type":"git","url":"git+https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer.git"},"license":"Apache-2.0","keywords":["node-red","bluemix","messenger"],"contributors":[{"name":"Soheel Chughtai","email":"soheel_chughtai@uk.ibm.com"}],"node-red":{"nodes":{"facebook-messenger-writer":"nodes/v1.js"}},"gitHead":"2274f0072902849637bab128fa02ab97f74322e1","bugs":{"url":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer/issues"},"homepage":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer#readme","_id":"node-red-contrib-facebook-messenger-writer@0.0.1","scripts":{},"_shasum":"e8555f2634658ca157ca11d8b0a0d82eea2889c1","_from":".","_npmVersion":"2.14.2","_nodeVersion":"4.0.0","_npmUser":{"name":"chughts","email":"soheel_chughtai@uk.ibm.com"},"dist":{"shasum":"e8555f2634658ca157ca11d8b0a0d82eea2889c1","tarball":"https://registry.npmjs.org/node-red-contrib-facebook-messenger-writer/-/node-red-contrib-facebook-messenger-writer-0.0.1.tgz"},"maintainers":[{"name":"chughts","email":"soheel_chughtai@uk.ibm.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/node-red-contrib-facebook-messenger-writer-0.0.1.tgz_1478265058406_0.6350319567136467"},"directories":{}},"0.0.2":{"name":"node-red-contrib-facebook-messenger-writer","version":"0.0.2","description":"A node to write output to Facebook Messenger","dependencies":{"request":"~2.53.0"},"repository":{"type":"git","url":"git+https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer.git"},"license":"Apache-2.0","keywords":["node-red","bluemix","messenger"],"contributors":[{"name":"Soheel Chughtai","email":"soheel_chughtai@uk.ibm.com"}],"node-red":{"nodes":{"facebook-messenger-writer":"nodes/v1.js"}},"gitHead":"9d113136cabd4146b9dd664f05aed9ce267695cb","bugs":{"url":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer/issues"},"homepage":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer#readme","_id":"node-red-contrib-facebook-messenger-writer@0.0.2","scripts":{},"_shasum":"d5b5d9ba7146cdee5c65ef6ecd15e6c51970b886","_from":".","_npmVersion":"2.14.2","_nodeVersion":"4.0.0","_npmUser":{"name":"chughts","email":"soheel_chughtai@uk.ibm.com"},"dist":{"shasum":"d5b5d9ba7146cdee5c65ef6ecd15e6c51970b886","tarball":"https://registry.npmjs.org/node-red-contrib-facebook-messenger-writer/-/node-red-contrib-facebook-messenger-writer-0.0.2.tgz"},"maintainers":[{"name":"chughts","email":"soheel_chughtai@uk.ibm.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/node-red-contrib-facebook-messenger-writer-0.0.2.tgz_1478460224602_0.03794329916127026"},"directories":{}},"0.0.3":{"name":"node-red-contrib-facebook-messenger-writer","version":"0.0.3","description":"A node to write output to Facebook Messenger","dependencies":{"request":"~2.53.0"},"repository":{"type":"git","url":"git+https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer.git"},"license":"Apache-2.0","keywords":["node-red","bluemix","messenger"],"contributors":[{"name":"Soheel Chughtai","email":"soheel_chughtai@uk.ibm.com"}],"node-red":{"nodes":{"facebook-messenger-writer":"nodes/v1.js"}},"gitHead":"cd6efb34aa4d0332c7f0b207151f9897b45cfae9","bugs":{"url":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer/issues"},"homepage":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer#readme","_id":"node-red-contrib-facebook-messenger-writer@0.0.3","scripts":{},"_shasum":"e8f456884a5b8dfb719d911b91515dc83db957c2","_from":".","_npmVersion":"2.14.2","_nodeVersion":"4.0.0","_npmUser":{"name":"chughts","email":"soheel_chughtai@uk.ibm.com"},"dist":{"shasum":"e8f456884a5b8dfb719d911b91515dc83db957c2","tarball":"https://registry.npmjs.org/node-red-contrib-facebook-messenger-writer/-/node-red-contrib-facebook-messenger-writer-0.0.3.tgz"},"maintainers":[{"name":"chughts","email":"soheel_chughtai@uk.ibm.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/node-red-contrib-facebook-messenger-writer-0.0.3.tgz_1496156965513_0.08284315164200962"},"directories":{}}},"readme":"# Node-RED Contrib Facebook Messenger Writer\n\nWriter Node for Facebook Messenger\n[Node-RED](http://nodered.org) Bluemix compatible node that writes to Facebook Messenger.\n\n\n## Install\n\nRun the following command in the root directory of your Node-RED install:\n\n````\n    npm install node-red-contrib-facebook-messenger-writer\n````\n\n## Usage\n\nThis node only writes to your Facebook page. To do that it needs a recipient id (which is normally the sender id from a message received) and an Access Token (something that you set up when you\nfollow the facebook messenger developers quick start guide.  [Facebook Messenger Developers Quick Start Guide](https://developers.facebook.com/docs/messenger-platform/guides/quick-start))\n\nThe message to send should be set in msg.payload\n\nThe node needs an ID to send the return message. As the recipient for the\nresponse is normally the sender of the original message, msg.facebookevent\ncan be set to the incoming message. The node will use the sender ID as the\nrecipient ID for the return.\n\neg.\n````\nmsg.facebookevent = {\n    \"sender\": { \"id\": \"111111111111\" },\n    \"recipient\": { \"id\": \"222222222222\" },\n    \"timestamp\": 1478167276278,\n    \"message\": {\n        \"mid\": \"mid.1478167276278:684dd80866\",\n        \"seq\": 6,\n        \"text\": \"Hello Mr Bot\"\n      }\n};\n````\n\nAlthough only the following is needed by the node.\n````\nmsg.facebookevent = {\n    \"sender\": { \"id\": \"111111111111\" }\n};\n````\n\nThe Node needs needs the Access Token, that facebook\nsets up for you to use. This is set in the Node's\nconfiguration.\n\n\n## Registering your GET with Facebook\n\nThere is no receiver node, as this can be readily accomplished using the standard HTTP Node-RED\nnodes. When following the Quick Start Guide, you can set a GET HTTP in node for the registration. The entry point you use is upto you. eg.\n\n````\n  \\mybot\\xyz\n````\n\nThis GET should check that the correct Access Token (which you specify\nwhen following the quick star guide) and echo back the challenge as sent\nby facebook.\n\neg:\n\n````\n  var mode = '';\n  var vtoken = '';\n  var challenge = '';\n  if (msg.payload['hub.mode']) {\n      mode = msg.payload['hub.mode'];\n  }\n  if (msg.payload['hub.verify_token']) {\n      vtoken = msg.payload['hub.verify_token'];\n  }\n  if (msg.payload['hub.challenge']) {\n    challenge = msg.payload['hub.challenge'];\n  }\n  if ('subscribe' == mode &&\n    'ThisStringShouldBeUniqueToYouRepresentsYourVerifyToken' == vtoken) {\n      msg.payload = challenge;\n    }\n\n````\n\n## Receiving Messages (POST) from Facebook\nOnce registered you can create a POST HTTP in for incoming messages.\nThe entry point should match your registration entry point eg.\n\n````\n  \\mybot\\xyz\n````\n\nIt's upto you how you handle the incoming message, but this is a sample\nhandling function that you can build your logic on.\n\n````\nif (msg.payload.object && 'page' == msg.payload.object) {\n    msg.processAS = 'NOTHING';\n    if (msg.payload.entry){\n        var entry = msg.payload.entry;\n\n        for (var i = 0; i < entry.length; i++) {\n            //console.log(myArray[j].x);\n            var pageID = entry[i].id;\n            var timeOfEvent = entry[i].time;\n            var messaging = entry[i].messaging\n            for (var j =0; j < messaging.length; j++) {\n                if (messaging[j].optin) {\n                    msg.processAS = 'AUTHENTICATION';     \n                } else if (messaging[j].message) {\n                  if(messaging[j].message.attachments) {\n                      if(messaging[j].message.attachments[0].type == \"location\") {\n                          msg.processAS = 'LOCATION';\n                      } else {\n                          msg.processAS = 'OTHER';\n                      }\n                  } else {\n                      msg.processAS = 'MESSAGE';\n                  }\n                } else if (messaging[j].delivery) {\n                    msg.processAS = 'DELIVERY';\n                } else if (messaging[j].postback) {\n                    msg.processAS = 'POSTBACK';\n                }\n                msg.messagingEvent = messaging[j];\n                node.send([msg,null]);               \n            }\n        }\n    }\n}\nreturn [null,msg];\n\n````\n\n## Contributing\n\nFor simple typos and fixes please just raise an issue pointing out our mistakes. If you need to raise a pull request please read our [contribution guidelines](https://github.com/node-red-contrib-utils/node-red-contrib-facebook-messenger-writer/blob/master/CONTRIBUTING.md) before doing so.\n\n## Copyright and license\n\nCopyright 2016 IBM Corp. under the Apache 2.0 license.\n","maintainers":[{"name":"chughts","email":"soheel_chughtai@uk.ibm.com"}],"time":{"modified":"2017-05-30T15:09:26.466Z","created":"2016-11-04T13:11:00.052Z","0.0.1":"2016-11-04T13:11:00.052Z","0.0.2":"2016-11-06T19:23:46.600Z","0.0.3":"2017-05-30T15:09:26.466Z"},"homepage":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer#readme","keywords":["node-red","bluemix","messenger"],"repository":{"type":"git","url":"git+https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer.git"},"contributors":[{"name":"Soheel Chughtai","email":"soheel_chughtai@uk.ibm.com"}],"bugs":{"url":"https://github.com/ibm-early-programs/node-red-contrib-facebook-messenger-writer/issues"},"license":"Apache-2.0","readmeFilename":"README.md","_attachments":{},"_etag":"\"592d8b26-27fc\"","_lastModified":"Tue, 30 May 2017 15:09:26 GMT"}